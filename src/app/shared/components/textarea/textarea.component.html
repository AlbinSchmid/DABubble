<section>
    <div id="mention-person" [ngStyle]="{'display': mentionPersonView ? 'block' : 'none'}">
        <h6>Mitglieder:</h6>
        <div id="trendline"></div>
        <div id="user-list" (click)="chooseMentionUser()">
            @for (user of usersToMention; track $index) {
                <div (click)="mentionPerson()">
                    <img src="{{ user.avatar }}" alt="">
                    <p>{{ user.userName }}</p>
                </div>
            }
        </div>
    </div>
    @if (!sourceThread) {
    <div id="interaction-div">
        <textarea [(ngModel)]="firebaseMessenger.content" name="textareaMessenger" #textarea
            pattern="^[\s\S]*\S[\s\S]*$" placeholder='{{chatOrChannelTxt()}}' #texterea="ngModel" required></textarea>
        <div id="interaction">
            <div id="button-container-left">
                <p>
                    <mat-icon (click)="fileInput.click()">add</mat-icon>
                    <input type="file" #fileInput (change)="onFileSelected($event)" accept="image/*,application/pdf"
                        multiple style="display: none;">
                </p>
                <div></div>
                <button (click)="openOrCloseEmojiBoard()"></button>
                <button *ngIf="messengerService.openChannel" (click)="openOrCloseMentionPersonView()"></button>
            </div>
            <button id="send-message-btn" (click)="uploadFiles(messenger);scrollDivDown()"
                *ngIf="texterea.valid || selectedFiles.length > 0"><img src="/assets/icons/send.png"
                    alt="send-icon"></button>
        </div>
    </div>
    <app-emoji-board *ngIf="showEmojiBoard" [binding]="textarea"
        (callFunction)="openOrCloseEmojiBoard()"></app-emoji-board>
    <div style="display: flex; gap: 15px; padding-top: 10px;">
        <div *ngFor="let file of selectedFiles">
            <div style="display: flex; align-items: flex-start; position: relative; cursor: pointer; flex-wrap: wrap;">
                <img style="width: 48px; height: 48px;" *ngIf="file.type.startsWith('image')" [src]="file.data"
                    (click)="viewFile(file)" class="preview-img" />
                <span (click)="deletePreviewFile(file)"
                    style="position: absolute; top: -15px; right: -10px; cursor: pointer;"><img
                        onmouseenter="this.style.scale = '1.3';" onmouseleave="this.style.scale = '1';"
                        style="rotate: 45deg;" src="/assets/icons/add-white.png" alt=""></span>
            </div>

            <div *ngIf="file.type === 'application/pdf'">
                <img style="width: 48px; height: 48px;" src="assets/icons/pdf.webp" alt="" (click)="viewFile(file)">
            </div>
        </div>
    </div>
    } @else {
    <textarea [(ngModel)]="firebaseMessenger.answerContent" name="textareaThread" #textarea placeholder='Antworten...'
        #texterea="ngModel" pattern="^[\s\S]*\S[\s\S]*$" required></textarea>

    <div id="interaction">
        <div id="button-container-left">
            <p>
                <mat-icon (click)="fileInput.click()">add</mat-icon>
                <input type="file" #fileInput (change)="onFileSelected($event)" accept="image/*,application/pdf"
                    multiple style="display: none;">
            </p>

            <div></div>

            <button (click)="openOrCloseEmojiBoard()"></button>
            <button *ngIf="messengerService.openChannel"></button>
            <button *ngIf="messengerService.openChannel"></button>
        </div>
        <button id="send-message-btn" (click)="uploadFiles('thread')" *ngIf="texterea.valid"><img
                src="/assets/icons/send.png" alt="send-icon"></button>
    </div>
    <app-emoji-board *ngIf="showEmojiBoard" [binding]="textarea"
        (callFunction)="openOrCloseEmojiBoard()"></app-emoji-board>
    <div style="display: flex; gap: 15px; padding-top: 10px;">
        <div *ngFor="let file of selectedFiles">
            <div style="display: flex; align-items: flex-start; position: relative;  cursor: pointer; flex-wrap: wrap;">
                <img style="width: 48px; height: 48px;" *ngIf="file.type.startsWith('image')" [src]="file.data"
                    (click)="viewFile(file)" class="preview-img" />
                <span (click)="deletePreviewFile(file)"
                    style="position: absolute; top: -15px; right: -10px; cursor: pointer;"><img
                        onmouseenter="this.style.scale = '1.3';" onmouseleave="this.style.scale = '1';"
                        style="rotate: 45deg;" src="/assets/icons/add-white.png" alt=""></span>
            </div>

            <div *ngIf="file.type === 'application/pdf'">
                <img style="width: 48px; height: 48px;" src="assets/icons/pdf.webp" alt="" (click)="viewFile(file)">
            </div>
        </div>
    </div>
    }
</section>